<?phpuse \Wptt\Main as Main;    foreach ($arResult['PROPERTIES'] as $key => $prop) {        switch ($prop['PROPERTY_TYPE']) {            //Получение реальных значений типа "Файл"            case 'F':                if (is_array($prop['VALUE'])) {                    foreach ($prop['VALUE'] as $arValue) {                        $arResult['PROPERTIES'][$key]['REAL_PATH'][] = CFile::GetPath($arValue);                        $rsFile = CFile::GetByID($prop['VALUE']);                        $arFile = $rsFile->Fetch();                        $size = CFile::FormatSize($arFile['FILE_SIZE']);                        $format = mb_strtoupper(\Bitrix\Main\IO\Path::getExtension(CFile::GetPath($arValue)));                        $arResult['PROPERTIES'][$key]['INFO'][] = $format . ', ' . $size;                    }                } else {                    $arResult['PROPERTIES'][$key]['REAL_PATH'] = CFile::GetPath($prop['VALUE']);                    $rsFile = CFile::GetByID($prop['VALUE']);                    $arFile = $rsFile->Fetch();                    $size = CFile::FormatSize($arFile['FILE_SIZE']);                    $format = mb_strtoupper(\Bitrix\Main\IO\Path::getExtension($arResult['PROPERTIES'][$key]['REAL_PATH']));                    $arResult['PROPERTIES'][$key]['INFO'] = $format . ', ' . $size;                }                break;                //Получение реальных значений типа "Привязка к элементу"            case 'E':                $arSelect = Array("ID", "NAME", "DATE_ACTIVE_FROM", 'PREVIEW_PICTURE', 'IBLOCK_ID', 'PREVIEW_TEXT', 'PROPERTY_*');                $arFilter = Array("IBLOCK_ID"=>$prop['LINK_IBLOCK_ID'], "ACTIVE_DATE"=>"Y", "ACTIVE"=>"Y", 'ID' => $prop['VALUE']);                $res = CIBlockElement::GetList(Array(), $arFilter, false, false, $arSelect);                while($ob = $res->GetNextElement())                {                    $arFields = $ob->GetFields();                    $arProps = $ob->GetProperties();                    $arFields['PREVIEW_PICTURE'] = CFile::GetPath($arFields['PREVIEW_PICTURE']);                    foreach ($arProps as $keyElementProp => $elementProp) {                        switch ($elementProp['PROPERTY_TYPE']) {                            //Получение реальных значений типа "Файл"                            case 'F':                                if (is_array($elementProp['VALUE'])) {                                    foreach ($elementProp['VALUE'] as $arValueElement) {                                        $arProps[$keyElementProp]['REAL_PATH'][] = CFile::GetPath($arValueElement);                                    }                                } else {                                    $arProps[$keyElementProp]['REAL_PATH'] = CFile::GetPath($elementProp['VALUE']);                                }                                break;                            //Получение реальных значений типа "Привязка к элементу"                            case 'E':                                $arSelectElement = Array("ID", "NAME", "DATE_ACTIVE_FROM", 'PREVIEW_PICTURE', 'DETAIL_TEXT', 'PREVIEW_TEXT', 'IBLOCK_ID', 'PROPERTY_*');                                $arFilterElement = Array("IBLOCK_ID"=>$elementProp['LINK_IBLOCK_ID'], "ACTIVE_DATE"=>"Y", "ACTIVE"=>"Y", 'ID' => $elementProp['VALUE']);                                $resElement = CIBlockElement::GetList(Array('NAME' => 'ASC'), $arFilterElement, false, false, $arSelectElement);                                while ($obElement = $resElement->GetNextElement()) {                                    $arFieldsElement = $obElement->GetFields();                                    $arPropsElement = $obElement->GetProperties();                                    $arFieldsElement['PREVIEW_PICTURE'] = CFile::GetPath($arFieldsElement['PREVIEW_PICTURE']);                                    if (is_array($elementProp['VALUE'])) {                                        $arProps[$keyElementProp]['ITEMS'][] = array_merge($arFieldsElement,$arPropsElement);                                    } else {                                        $arProps[$keyElementProp]['ITEM'] = array_merge($arFieldsElement,$arPropsElement);                                    }                                }                        }                    }                    if (is_array($prop['VALUE'])) {                        $arResult['PROPERTIES'][$key]['ITEMS'][] = array_merge($arFields,$arProps);                    } else {                        $arResult['PROPERTIES'][$key]['ITEM'] = array_merge($arFields,$arProps);                    }                }                break;            //Получение реальных значений типа "Привязка к разделу"            case 'G':                $arSelect = Array("ID", "NAME", "DATE_ACTIVE_FROM", 'PREVIEW_PICTURE', 'IBLOCK_ID', 'PROPERTY_*');                $arFilter = Array("IBLOCK_ID"=>$prop['LINK_IBLOCK_ID'], "ACTIVE_DATE"=>"Y", "ACTIVE"=>"Y", 'SECTION_ID' => $prop['VALUE']);                $res = CIBlockElement::GetList(Array(), $arFilter, false, false, $arSelect);                while ($ob = $res->GetNextElement()) {                    $arFields = $ob->GetFields();                    $arProps = $ob->GetProperties();                    $arFields['PREVIEW_PICTURE'] = CFile::GetPath($arFields['PREVIEW_PICTURE']);                    foreach ($arProps as $keyElementProp => $elementProp) {                        switch ($elementProp['PROPERTY_TYPE']) {                            case 'F':                                if (is_array($elementProp['VALUE'])) {                                    foreach ($elementProp['VALUE'] as $arValueElement) {                                        $arProps[$keyElementProp]['REAL_PATH'][] = CFile::GetPath($arValueElement);                                    }                                } else {                                    $arProps[$keyElementProp]['REAL_PATH'] = CFile::GetPath($elementProp['VALUE']);                                }                                break;                            default:                                break;                        }                    }                        $arResult['PROPERTIES'][$key]['ITEMS'][] = array_merge($arFields,$arProps);                }                break;            default:                break;        }    }    if ($arResult['IBLOCK_SECTION_ID'] === '5') {        $arResult['STUDYING_PERIOD'] = $arResult['PROPERTIES']['STUDYING_PERIOD']['VALUE'] . ' ч';    } else {        $arResult['STUDYING_PERIOD'] = 'от ';        if ($arResult['PROPERTIES']['STUDYING_PERIOD_YEAR']['VALUE']) {            $arResult['STUDYING_PERIOD'] .= $arResult['PROPERTIES']['STUDYING_PERIOD_YEAR']['VALUE'] . ' ' .  Main::num2word($arResult['PROPERTIES']['STUDYING_PERIOD_YEAR']['VALUE'], ['года','лет','лет']) . ' ';        }        if ($arResult['PROPERTIES']['STUDYING_PERIOD_MONTH']['VALUE']) {            $arResult['STUDYING_PERIOD'] .= $arResult['PROPERTIES']['STUDYING_PERIOD_MONTH']['VALUE'] . ' ' . 'мес.';        }    }    $arResult['INFO_PROGRAM'][] = 'Программа подготовки - ' . $arResult['NAME'] . ' ';    foreach ($arResult['PROPERTIES'] as $key => $prop) {        if ($prop['VALUE'] !== '') {            if ($prop['PROPERTY_TYPE'] === 'E') {                $arResult['INFO_PROGRAM'][] = $prop['NAME'] . ' - ' . $arResult['PROPERTIES'][$key]['ITEM']['NAME'] .  ' ';            } else {                $arResult['INFO_PROGRAM'][] = $prop['NAME'] . ' - ' . $prop['VALUE'] .  ' ';            }        }    }